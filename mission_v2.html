<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Explora√ß√£o de Halloween</title>
  <style>
    body {
      background-color: #79c238;
    }
    
    .round-button {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      border: none;
      background-color: #E4C58A;
      color: white;
      font-size: 16px;
      cursor: pointer;
      text-align: center;
      line-height: 80px;
      transition: background-color 0.3s;
      margin: 10px;
    }

    .round-button:hover {
      background-color: #D4B57A;
    }

    .grid-cell {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1em;
      border: 0;
      width: 2vw;
      height: 2vw;
      padding: 0;
      line-height: 50px;
      box-sizing: border-box;
    }

    #gameGrid {
      display: grid;
      gap: 0px;
      grid-gap: 0;
      padding: 0;
      margin: 0;
      justify-content: center;
      margin-top: 20px;
    }

    #gameMessage {
      font-weight: bold;
      color: white;
    }
    
 .mirror {
  transform: scaleX(-1);
}

  </style>
</head>
<body>
  <div style="text-align: center;">
    <h2 style="color: white;">Monkey maze</h2>

    <p style="color: white;">Find all the strawberries!</p>

    <!-- Bot√£o de reiniciar -->
    <div style="margin-top: 20px;">
      <button id="restartButton" class="round-button" style="color: white;">Start</button>
    </div>

    <!-- Seletor de Grid -->
    <div>
      <label for="gridSelector" style="color: white;">Maze:</label>
      <select id="gridSelector">
        <option value="grid1">1</option>
        <!-- Adicione os grids 2 e 3 se desejar -->
      </select>
      <button id="loadGridButton" class="round-button">Load</button>
    </div>
    
    <!-- Grade -->
    <div id="gameGrid">
      <!-- Grid gerado aqui -->
    </div>

    <!-- Mensagens de jogo -->
    <p id="gameMessage" style="color: white; font-weight: bold;"></p>
    <p style="color: white;">Strawberries collected: <span id="collectedItems">0</span> / <span id="totalItems">0</span></p>
    <p style="color: white;">Lifes: <span id="lifeCount">3</span></p>
    <p style="color: white;">Elapsed Time: <span id="timeElapsed">0</span> seconds</p>
    <p id="invincibilityStatus" style="color: cyan;"></p>
    <p id="powerUpStatus" style="color: yellow;"></p>
  </div>
  
  <script>
    // Defini√ß√£o de tipos de terreno
    const terrainTypes = {
      'P': { color: '#191970', text: '' },    // Personagem principal (n√£o ser√° usado)
      'B': { color: '#4d2558', text: '' },    // Barreira
      'E': { color: '#79c238', text: '' },    // Espa√ßo vazio
      'R': { color: '#79c238', text: 'üçì' },  // Recompensa 
      'S': { color: '#79c238', text: '‚ö°' },  // Puper Pulo
      'W': { color: '#33b5ea', text: '' },  // √Årea L√≠quida
      'G': { color: '#bce8fa', text: 'Ô∏è' },  // Gravidade Reduzida (Espa√ßo/Lua/Nuvem)
      'M': { color: '#79c238', text: 'üå™Ô∏è' },  // Mola
      'H': { color: '#79c238', text: 'ü´ßÔ∏è' },  // Escada
      'X': { color: '#79c238', text: 'üåµ' },  // Espinho
      '+': { color: '#79c238', text: '‚ù§Ô∏è' },  // Vida Extra
      'F': { color: '#79c238', text: 'ü¶ã' },  // voo
      'Z': { color: '#79c238', text: 'üèÅ' },  // final
      'N': { color: 'transparent', text: '' } // Inimigo (ser√° renderizado separadamente)
    };

    // Mapa maior (20x20)
    const grids = {
      'grid1': [
        
  ['E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'B', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'R', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'B', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'B', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'R', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'B', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'B', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'R', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'B', 'B', 'B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'B', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'B', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'R', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'W', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['B', 'E', 'E', 'B', 'E', 'E', 'E', 'E', 'G', 'G', 'G', 'G', 'H', 'W', 'W', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['B', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'G', 'G', 'G', 'G', 'H', 'W', 'W', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E', 'E'],
        ['E', 'E', 'E', 'E', 'E', 'R', 'E', 'B', 'G', 'G', 'G', 'B', 'H', 'E', '+', 'B', 'E', 'B', 'E', 'B'],
        ['E', 'M', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'E', 'B', 'H', 'E', 'E', 'B', 'E', 'B', 'E', 'B'],
        ['E', 'E', 'E', 'E', 'E', 'E', 'E', 'B', 'E', 'X', 'E', 'B', 'H', 'E', 'E', 'B', 'E', 'B', 'E', 'B'],
        ['F', 'E', 'N', 'E', 'E', 'E', 'E', 'B', 'E', 'E', 'S', 'B', 'H', 'E', 'E', 'B', 'E', 'E', 'Z', 'B'],
        ['B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'H', 'B', 'B', 'B', 'B', 'B', 'B', 'B'] // Ch√£o

      ]
      // Adicione grids adicionais se desejar
    };

    const gridRows = 15;  // N√∫mero de linhas vis√≠veis
    const gridCols = 20;  // N√∫mero de colunas vis√≠veis

    // Atualizar o estilo do grid com base em gridCols
    document.getElementById('gameGrid').style.gridTemplateColumns = `repeat(${gridCols}, 2vw)`;

    let currentGrid = []; // Grid atual
    let startRow = 0;    // Linha inicial vis√≠vel no mapa grande
    let startCol = 0;    // Coluna inicial vis√≠vel no mapa grande
    let playerPosition = { row: 0, col: 0 }; // Posi√ß√£o no grid (inteira)
    let playerRealRow = 0; // Posi√ß√£o real vertical (decimal)

    let collectedItems = 0; // N√∫mero de recompensas coletadas
    let totalItems = 0;     // Total de itens para coletar
    let timerInterval;
    let timeElapsed = 0;
    let gameOver = false;

    let verticalSpeed = 0;
    const gravity = 25; // Gravidade padr√£o (unidades por segundo ao quadrado)
    const defaultJumpStrength = -13; // For√ßa de pulo original
    let jumpStrength = defaultJumpStrength; // For√ßa de pulo atual
    const maxVerticalSpeed = 10; // Velocidade vertical m√°xima

    // Vari√°veis para o Super Pulo
    let superJumpActive = false;
    let superJumpTimeout;
    let superJumpInterval;

    // Vari√°veis para o sistema de vidas
    let life = 3;
    const maxLife = 5;

    // Lista de inimigos
    let enemies = [];

    // Vari√°vel para o loop de jogo
    let lastTime = null;
    
    let playerDirection = { x: 0, y: 0 };
    
    let isInvincible = false; // Adiciona a vari√°vel de invencibilidade
    
    let flyActive = false;        // Indica se o voo est√° ativo
		let flyTimeout;               // Timer para desativar o voo
		let flyInterval;              // Intervalo para atualizar o tempo restante
		let flyRemainingTime = 0; 


// Fun√ß√£o para fazer uma c√≥pia profunda do grid
function deepCopyGrid(grid) {
  return grid.map(row => row.slice());
}

// Fun√ß√£o para iniciar o timer
function startTimer() {
  clearInterval(timerInterval);
  timeElapsed = 0;
  document.getElementById('timeElapsed').textContent = timeElapsed;
  timerInterval = setInterval(() => {
    timeElapsed++;
    document.getElementById('timeElapsed').textContent = timeElapsed;
  }, 1000);
}

// Fun√ß√£o para parar o timer
function stopTimer() {
  clearInterval(timerInterval);
}

// Fun√ß√£o para calcular o total de itens no grid
function calculateTotalItems(grid) {
  let count = 0;
  grid.forEach(row => {
    row.forEach(cell => {
      if (['R', 'R', 'R', 'R'].includes(cell)) {
        count++;
      }
    });
  });
  return count;
}


// Fun√ß√£o para exibir mensagens ao jogador
function displayMessage(message) {
  const gameMessage = document.getElementById('gameMessage');
  gameMessage.textContent = message;
  setTimeout(() => {
    if (gameMessage.textContent === message) {
      gameMessage.textContent = '';
    }
  }, 3000);
}

// Fun√ß√£o para atualizar a √°rea vis√≠vel
function updateVisibleArea() {
  // Centraliza o personagem na √°rea vis√≠vel
  startRow = playerPosition.row - Math.floor(gridRows / 2);
  startCol = playerPosition.col - Math.floor(gridCols / 2);

  // Garantir que startRow e startCol estejam dentro dos limites do mapa
  startRow = Math.max(0, Math.min(startRow, currentGrid.length - gridRows));
  startCol = Math.max(0, Math.min(startCol, currentGrid[0].length - gridCols));
}

// Fun√ß√£o para renderizar o grid
function renderGrid() {
  const gridContainer = document.getElementById('gameGrid');
  gridContainer.innerHTML = ''; // Limpa o grid anterior

  // Renderiza a parte vis√≠vel do mapa
  for (let row = 0; row < gridRows; row++) {
    for (let col = 0; col < gridCols; col++) {
      const actualRow = startRow + row;
      const actualCol = startCol + col;

      // Verifica se est√° dentro dos limites do mapa
      if (actualRow >= currentGrid.length || actualCol >= currentGrid[0].length || actualRow < 0 || actualCol < 0) continue;

      const cell = currentGrid[actualRow][actualCol];
      const cellDiv = document.createElement('div');
      cellDiv.className = 'grid-cell';

      // Define a cor de fundo com base no tipo de terreno
      cellDiv.style.backgroundColor = terrainTypes[cell]?.color || '#79c238';

      // Define o conte√∫do da c√©lula
      if (actualRow === playerPosition.row && actualCol === playerPosition.col) {
        cellDiv.classList.add('mirror');
        cellDiv.style.color = '#79c238';
        cellDiv.textContent = 'üêí'; // Ab√≥bora
        if (isInvincible) {
          // Aplica um efeito visual para indicar invencibilidade
          cellDiv.style.opacity = 0.5; // Torna o personagem semi-transparente
        } else {
          cellDiv.style.opacity = 1; // Opacidade normal
        }
        cellDiv.style.color = 'white';
      } else {
        cellDiv.textContent = terrainTypes[cell]?.text || '';
        cellDiv.style.color = 'white';
      }

      gridContainer.appendChild(cellDiv);
    }
  }

  // Renderiza os inimigos
  enemies.forEach(enemy => {
    const index = (enemy.row - startRow) * gridCols + (enemy.col - startCol);
    if (index >= 0 && index < gridContainer.children.length) {
      const cellDiv = gridContainer.children[index];
      cellDiv.textContent = 'ü¶Ç'; // Emoji do inimigo
      cellDiv.style.color = '#79c238';
    }
  });
}

// Fun√ß√£o para obter os par√¢metros f√≠sicos com base na √°rea atual
function getPhysicsParameters() {
  const cell = currentGrid[playerPosition.row][playerPosition.col];
  let gravityValue = gravity; // Gravidade padr√£o
  let jumpStrengthValue = defaultJumpStrength; // For√ßa de pulo padr√£o

  if (cell === 'W') {
    // √Årea L√≠quida: gravidade reduzida, pulo mais fraco
    gravityValue = gravity * 0.5;
    jumpStrengthValue = defaultJumpStrength * 0.5;
  } else if (cell === 'G') {
    // Gravidade Reduzida: gravidade menor, pulo maior
    gravityValue = gravity * 0.3;
    jumpStrengthValue = defaultJumpStrength * 1.5;
  }

  // Se o Super Pulo estiver ativo, aumenta a for√ßa do pulo
  if (superJumpActive) {
    jumpStrengthValue *= 1.5;
  }
  
  if (flyActive) {
	  gravityValue = gravity * 0.5; // Gravidade reduzida durante o voo
	}
	
  return { gravityValue, jumpStrengthValue };
}

// Fun√ß√£o para aplicar a gravidade
function applyGravity(deltaTime) {
  // Verifica se o jogador est√° em uma escada
  const currentCell = currentGrid[playerPosition.row][playerPosition.col];
  if (currentCell === 'H') {
    verticalSpeed = 0;
    playerDirection.y = 0; // Sem movimento vertical
    return; // N√£o aplica gravidade
  }

  // Obter os par√¢metros f√≠sicos atuais
  const { gravityValue } = getPhysicsParameters();

  // Aplica a gravidade √† velocidade vertical
  verticalSpeed += gravityValue * deltaTime;

  // Limitar a velocidade vertical
  verticalSpeed = Math.min(verticalSpeed, maxVerticalSpeed);

  // Atualiza a dire√ß√£o vertical do jogador
  if (verticalSpeed > 0) {
    playerDirection.y = 1; // Movendo para baixo
  } else if (verticalSpeed < 0) {
    playerDirection.y = -1; // Movendo para cima
  } else {
    playerDirection.y = 0; // Sem movimento vertical
  }

  // Calcula a nova posi√ß√£o vertical potencial
  let newPlayerRealRow = playerRealRow + verticalSpeed * deltaTime;

  let col = playerPosition.col;

  // Movendo para baixo
  if (verticalSpeed > 0) {
    let bottomRow = Math.floor(newPlayerRealRow + 1);

    if (bottomRow >= currentGrid.length) {
      // Chegou ao fundo do grid
      playerRealRow = bottomRow - 1;
      verticalSpeed = 0;
      playerDirection.y = 0; // Parado verticalmente
    } else {
      const cellBelow = currentGrid[bottomRow][col];
      if (cellBelow === 'B' || cellBelow === 'M') {
        // Colis√£o com barreira ou mola
        playerRealRow = bottomRow - 1;
        if (cellBelow === 'M') {
          verticalSpeed = -15; // Impulso da mola
          playerDirection.y = -1; // Atualiza a dire√ß√£o para cima
          displayMessage('Super Jump!');
        } else {
          verticalSpeed = 0;
          playerDirection.y = 0; // Parado verticalmente
        }
      } else {
        playerRealRow = newPlayerRealRow;
      }
    }
  }
  // Movendo para cima
  else if (verticalSpeed < 0) {
    let topRow = Math.floor(newPlayerRealRow);

    if (topRow < 0) {
      // Bateu no topo do grid
      playerRealRow = topRow + 1;
      verticalSpeed = 0;
      playerDirection.y = 0; // Parado verticalmente
    } else if (currentGrid[topRow][col] === 'B') {
      // Colis√£o com barreira acima
      playerRealRow = topRow + 1;
      verticalSpeed = 0;
      playerDirection.y = 0; // Parado verticalmente
    } else {
      playerRealRow = newPlayerRealRow;
    }
  }
  // Sem movimento vertical
  else {
    playerDirection.y = 0; // Sem movimento vertical
    playerRealRow = newPlayerRealRow;
  }

  // Atualiza a posi√ß√£o no grid para renderiza√ß√£o
  playerPosition.row = Math.round(playerRealRow);

  // Coleta itens ou verifica perigos na nova posi√ß√£o
  collectItem();
  checkHazards();
}

// Fun√ß√£o para verificar se o jogador est√° no ch√£o
function isOnGround() {
  let bottomRow = Math.floor(playerRealRow + 0.9) + 1;

  if (bottomRow >= currentGrid.length) return true;

  return currentGrid[bottomRow][playerPosition.col] === 'B' || currentGrid[bottomRow][playerPosition.col] === 'M';
}

    // Fun√ß√£o para o pulo
function jump() {
  if (isOnGround() || flyActive) {
    const { jumpStrengthValue } = getPhysicsParameters();
    verticalSpeed = jumpStrengthValue;
    playerDirection.y = -1; // Dire√ß√£o para cima
  }
}

// Atualize a fun√ß√£o 'updatePowerUpStatus'
function updatePowerUpStatus() {
  let statusMessages = [];

  if (superJumpActive && superJumpRemainingTime > 0) {
    statusMessages.push(`Super Jump active: ${superJumpRemainingTime}s`);
  }

  if (flyActive && flyRemainingTime > 0) {
    statusMessages.push(`Active flight: ${flyRemainingTime}s`);
  }

  document.getElementById('powerUpStatus').textContent = statusMessages.join(' | ');
}


function activateFly() {
  if (flyActive) {
    // Se j√° est√° ativo, reseta o timer
    clearTimeout(flyTimeout);
    clearInterval(flyInterval);
  } else {
    flyActive = true;
  }

  flyRemainingTime = 15; // 15 segundos
  
  updatePowerUpStatus();

  // Inicia um intervalo para atualizar a contagem regressiva
flyInterval = setInterval(() => {
  flyRemainingTime--;
  if (flyRemainingTime > 0) {
    updatePowerUpStatus();
  } else {
    flyRemainingTime = 0;
    updatePowerUpStatus();
    clearInterval(flyInterval);
  }
}, 1000);



  // Configura o timer para desativar o voo ap√≥s 15 segundos
  flyTimeout = setTimeout(() => {
    deactivateFly();
  }, 15000); // 15000 milissegundos = 15 segundos
}

function deactivateFly() {
  flyActive = false;
  flyRemainingTime = 0;
  clearInterval(flyInterval);
  updatePowerUpStatus();
  displayMessage('The power of flight has ended.');
}

// Fun√ß√£o para mover a ab√≥bora
function movePlayer(direction) {
  if (gameOver) return;

  let newCol = playerPosition.col;
  playerDirection.x = 0; // Reseta a dire√ß√£o horizontal

  if (direction === 'right') {
    newCol++;
    playerDirection.x = 1;
  }
  if (direction === 'left') {
    newCol--;
    playerDirection.x = -1;
  }

  // Manter a ab√≥bora dentro dos limites do mapa
  if (newCol < 0 || newCol >= currentGrid[0].length) {
    displayMessage("You can't move in that direction!");
    return;
  }

  // Verificar se h√° barreira na nova posi√ß√£o
  let topRow = Math.floor(playerRealRow);
  let bottomRow = Math.floor(playerRealRow + 0.9);

  if (
    currentGrid[topRow][newCol] === 'B' ||
    currentGrid[bottomRow][newCol] === 'B'
  ) {
    displayMessage("You've hit a wall!");
    return;
  }

  // Atualiza a posi√ß√£o horizontal do jogador
  playerPosition.col = newCol;


  // Coleta itens ou verifica perigos na nova posi√ß√£o
  collectItem();
  checkHazards();
}

// Fun√ß√£o para subir ou descer escadas
function climbLadder(direction) {
  let newRow = playerPosition.row;
  if (direction === 'up') {
    newRow--;
  } else if (direction === 'down') {
    newRow++;
  }

  // Verifica os limites do grid
  if (newRow < 0 || newRow >= currentGrid.length) return;

  // Verifica se a nova posi√ß√£o √© uma escada
  if (currentGrid[newRow][playerPosition.col] === 'H') {
    playerRealRow = newRow;
    verticalSpeed = 0; // Reseta a velocidade vertical
    playerPosition.row = newRow;
  }
}

// Fun√ß√£o para coletar itens
function collectItem() {
  const cell = currentGrid[playerPosition.row][playerPosition.col];

  if (cell === 'S') {
    // Ativa o Super Pulo
    activateSuperJump();
    displayMessage('Super Jump activated for 15 seconds!');
    currentGrid[playerPosition.row][playerPosition.col] = 'E'; // Limpa a c√©lula
  } else if (cell === 'F') {
    activateFly();
    displayMessage('Flight activated for 15 seconds!');
    currentGrid[playerPosition.row][playerPosition.col] = 'E'; // Limpa a c√©lula
  } else if (cell === '+') {
    if (life < maxLife) {
      life++;
      document.getElementById('lifeCount').textContent = life;
      displayMessage("You've been given a life!");
      currentGrid[playerPosition.row][playerPosition.col] = 'E'; // Remove o item do grid
    } else {
      displayMessage('Maximum life reached!');
    }
  } else if (['R', 'R', 'R', 'R'].includes(cell)) {
    collectedItems++;
    document.getElementById('collectedItems').textContent = collectedItems;
    displayMessage('You collected a strawberry!');
    currentGrid[playerPosition.row][playerPosition.col] = 'E'; // Limpa a c√©lula ap√≥s coletar

    // Verifica se todas as recompensas foram coletadas
    if (collectedItems === totalItems) {
      displayMessage('All strawberries collected! Look for the flag to finish.');
    }
  }
}


function checkHazards() {
  const cell = currentGrid[playerPosition.row][playerPosition.col];
  if (cell === 'X') {
    loseLife();
  } else if (cell === 'Z') {
    checkEndCondition();
  }
}

function checkEndCondition() {
  if (collectedItems === totalItems) {
    gameOver = true;
    displayMessage('Congratulations! You completed the challenge!');
    stopTimer();
  } else {
    displayMessage('Collect all the strawberries to complete the challenge!');
  }
}

// Fun√ß√£o para perder uma vida
function loseLife() {
  if (isInvincible || gameOver) return; // N√£o perde vida se estiver invenc√≠vel ou se o jogo j√° acabou

  life--;
  document.getElementById('lifeCount').textContent = life;
  displayMessage('You lost a life!');

  if (life <= 0) {
    gameOver = true;
    displayMessage('Game Over!');
    stopTimer();
  } else {
    // Inicia o per√≠odo de invencibilidade
    isInvincible = true;

    // Feedback visual (opcional)
    let invincibilityRemainingTime = 5; // 5 segundos

    document.getElementById('invincibilityStatus').textContent = `Invenc√≠vel por: ${invincibilityRemainingTime}s`;

    let invincibilityInterval = setInterval(() => {
      invincibilityRemainingTime--;
      if (invincibilityRemainingTime > 0) {
        document.getElementById('invincibilityStatus').textContent = `Invenc√≠vel por: ${invincibilityRemainingTime}s`;
      } else {
        document.getElementById('invincibilityStatus').textContent = '';
        clearInterval(invincibilityInterval);
      }
    }, 1000);

    // Configura um temporizador para terminar a invencibilidade ap√≥s 5 segundos
    setTimeout(() => {
      isInvincible = false;
      // Remove o efeito visual de invencibilidade (se aplicado)
    }, 5000); // 5000 milissegundos = 5 segundos
  }
}

// Fun√ß√£o para ativar o Super Pulo
function activateSuperJump() {
  if (superJumpActive) {
    // Se j√° est√° ativo, reseta o timer
    clearTimeout(superJumpTimeout);
    clearInterval(superJumpInterval);
  } else {
    superJumpActive = true;
    // A for√ßa do pulo ser√° ajustada na fun√ß√£o getPhysicsParameters
  }

  let superJumpRemainingTime = 15; // 15 segundos

  // Atualiza a exibi√ß√£o do status do power-up
  document.getElementById('powerUpStatus').textContent = `Super Jump active: ${superJumpRemainingTime}s`;

  // Inicia um intervalo para atualizar a contagem regressiva
  superJumpInterval = setInterval(() => {
    superJumpRemainingTime--;
    if (superJumpRemainingTime > 0) {
      document.getElementById('powerUpStatus').textContent = `Super Jump active: ${superJumpRemainingTime}s`;
    } else {
      document.getElementById('powerUpStatus').textContent = '';
      clearInterval(superJumpInterval);
    }
  }, 1000);

  // Configura o timer para desativar o Super Pulo ap√≥s 15 segundos
  superJumpTimeout = setTimeout(() => {
    deactivateSuperJump();
  }, 15000); // 15000 milissegundos = 15 segundos
}

// Fun√ß√£o para desativar o Super Pulo
function deactivateSuperJump() {
  // A for√ßa de pulo ser√° restaurada na fun√ß√£o getPhysicsParameters
  superJumpActive = false;
  clearInterval(superJumpInterval);
  document.getElementById('powerUpStatus').textContent = '';
  displayMessage('The Super Jump is over.');
}

// Fun√ß√£o para inicializar os inimigos
function initializeEnemies() {
  enemies = [];
  for (let row = 0; row < currentGrid.length; row++) {
    for (let col = 0; col < currentGrid[0].length; col++) {
      if (currentGrid[row][col] === 'N') {
        enemies.push({ row: row, col: col, direction: 1 });
        currentGrid[row][col] = 'E'; // Limpa a c√©lula no grid
      }
    }
  }
}

// Fun√ß√£o para mover os inimigos
function moveEnemies() {
  enemies.forEach(enemy => {
    let newCol = enemy.col + enemy.direction;

    // Verifica limites e barreiras
    if (newCol < 0 || newCol >= currentGrid[0].length || currentGrid[enemy.row][newCol] === 'B') {
      // Inverte a dire√ß√£o
      enemy.direction *= -1;
      newCol = enemy.col + enemy.direction;
    }

    // Atualiza a posi√ß√£o do inimigo
    enemy.col = newCol;
  });
}


function checkEnemyCollisions() {
  enemies.forEach((enemy, index) => {
    // Verifica se o inimigo est√° pr√≥ximo o suficiente do jogador
    const rowDifference = Math.abs(enemy.row - playerRealRow);
    const colDifference = Math.abs(enemy.col - playerPosition.col);

    if (rowDifference < 0.9 && colDifference < 0.9) {
      if (playerDirection.y > 0) {
        // O jogador est√° se movendo para baixo (caindo)
        enemies.splice(index, 1); // Remove o inimigo
        verticalSpeed = -10; // Impulso para cima
        displayMessage('You have defeated an enemy!');
      } else {
        // Colis√£o com o inimigo (parado ou movimento lateral)
        loseLife();
      }
    }
  });
}



// Vari√°veis para controlar o movimento dos inimigos
let enemyMoveInterval = 1; // Intervalo de movimento dos inimigos em segundos
let enemyMoveTimer = 0;      // Temporizador para controlar o movimento dos inimigos

// Fun√ß√£o para o loop principal do jogo
function gameLoop(currentTime) {
  if (lastTime === null) {
    lastTime = currentTime;
  }
  const deltaTime = (currentTime - lastTime) / 1000; // Converte para segundos
  lastTime = currentTime;

  applyGravity(deltaTime);

  // Atualiza o temporizador dos inimigos
  enemyMoveTimer += deltaTime;
  if (enemyMoveTimer >= enemyMoveInterval) {
    moveEnemies();
    enemyMoveTimer = 0; // Reseta o temporizador
  }

  checkEnemyCollisions();
  updateVisibleArea(); // Atualiza a √°rea vis√≠vel com base na posi√ß√£o do jogador
  renderGrid();

  if (!gameOver) {
    requestAnimationFrame(gameLoop);
  }
}
    // Fun√ß√£o para reiniciar o estado do jogo
function resetGameState() {
  collectedItems = 0;
  timeElapsed = 0;
  gameOver = false;
  verticalSpeed = 0;
  playerRealRow = playerPosition.row = 0;
  superJumpActive = false;
  flyActive = false;
  isInvincible = false;
  clearTimeout(superJumpTimeout);
  clearInterval(superJumpInterval);
  clearTimeout(flyTimeout);
  clearInterval(flyInterval);
  flyRemainingTime = 0;
  superJumpRemainingTime = 0;
  document.getElementById('powerUpStatus').textContent = '';
  document.getElementById('invincibilityStatus').textContent = '';
  document.getElementById('collectedItems').textContent = collectedItems;
  document.getElementById('lifeCount').textContent = 3;
  document.getElementById('gameMessage').textContent = '';

  // Reinicia o loop do jogo
  lastTime = null;
  requestAnimationFrame(gameLoop);
}


// Fun√ß√£o para carregar o grid selecionado
function loadSelectedGrid() {
  const selectedGrid = document.getElementById('gridSelector').value;
  currentGrid = deepCopyGrid(grids[selectedGrid]);
  playerPosition.col = 0;
  playerRealRow = playerPosition.row = 0;
  startRow = 0;
  startCol = 0;
  resetGameState();
  totalItems = calculateTotalItems(currentGrid);
  document.getElementById('totalItems').textContent = totalItems;
  startTimer();
  initializeEnemies();
  renderGrid();
}

// Event listeners do teclado
document.addEventListener('keydown', (event) => {
  if (event.code === 'Space') {
    event.preventDefault();
    jump();
  } else if (['ArrowLeft', 'ArrowRight'].includes(event.key)) {
    const direction = event.key.replace('Arrow', '').toLowerCase();
    movePlayer(direction);
  } else if (['ArrowUp', 'ArrowDown'].includes(event.key)) {
    const direction = event.key.replace('Arrow', '').toLowerCase();
    climbLadder(direction);
  }
});

// Event listeners dos bot√µes de interface
document.getElementById('restartButton').addEventListener('click', loadSelectedGrid);
document.getElementById('loadGridButton').addEventListener('click', loadSelectedGrid);

// Iniciar o jogo carregando o primeiro grid
loadSelectedGrid();

  </script>
</body>
</html>
